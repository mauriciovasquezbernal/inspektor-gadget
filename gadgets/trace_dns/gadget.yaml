name: dns
description: trace dns requests and responses
#tracers:
#  dns:
#    mapName: events
#    structName: event_t
metrics:
  #manualStats:
  stats:
    generate: true
    labels:
      - name: mnt_ns_id
        cType: mnt_ns_id_t
      - name: pid
        cType: __u32
      - name: tid
        cType: __u32
      - name: uid
        cType: __u32
      - name: gid
        cType: __u32
      - name: task
        cType: task
    values:
      - name: count
        cType: __u32
      - name: count2
        cType: __u32
structs:
  event_t:
    fields:
    - name: src
      description: Source endpoint
      attributes:
        minWidth: 24
        maxWidth: 50
    - name: dst
      description: Destination endpoint
      attributes:
        minWidth: 24
        maxWidth: 50
    - name: pid
      description: PID of the process that sent the request
      attributes:
        template: pid
    - name: task
      attributes:
        template: comm
    - name: uid
      attributes:
        hidden: true
        template: uid
    - name: gid
      attributes:
        hidden: true
        template: uid
    - name: name
      attributes:
        width: 30
    - name: qr
      attributes:
        width: 2
    - name: pkt_type
      attributes:
        width: 8
    - name: rcode
      attributes:
        width: 8
    - name: latency_ns
      attributes:
        width: 8
        hidden: true
    - name: anaddr
      attributes:
        width: 16
    - name: netns
      description: 'TODO: Fill field description'
      attributes:
        width: 16
        alignment: left
        hidden: true
        ellipsis: end
    - name: tid
      description: 'TODO: Fill field description'
      attributes:
        width: 16
        alignment: left
        hidden: true
        ellipsis: end
    - name: id
      description: 'TODO: Fill field description'
      attributes:
        width: 16
        alignment: left
        hidden: true
        ellipsis: end
    - name: qtype
      description: 'TODO: Fill field description'
      attributes:
        width: 16
        alignment: left
        ellipsis: end
    - name: ancount
      description: 'TODO: Fill field description'
      attributes:
        width: 16
        alignment: left
        hidden: true
        ellipsis: end
    - name: anaddrcount
      description: 'TODO: Fill field description'
      attributes:
        width: 16
        alignment: left
        hidden: true
        ellipsis: end
